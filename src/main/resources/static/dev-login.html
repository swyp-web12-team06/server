<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¡ ê°œë°œìš© ê°„í¸ ë¡œê·¸ì¸</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; height: 100vh; }
        .login-card { width: 100%; max-width: 400px; padding: 2rem; background: white; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .token-box { background: #e9ecef; padding: 10px; border-radius: 5px; word-break: break-all; font-family: monospace; font-size: 0.85rem; display: none; }
    </style>
</head>
<body>

<div class="login-card">
    <h3 class="text-center mb-4">âš¡ Dev Login</h3>

    <div class="mb-3">
        <label for="userId" class="form-label">User ID</label>
        <input type="number" class="form-control" id="userId" value="1" placeholder="User ID ì…ë ¥">
    </div>

    <div class="mb-3">
        <label for="role" class="form-label">Role</label>
        <select class="form-select" id="role">
            <option value="USER" selected>USER (ì¼ë°˜ ì‚¬ìš©ì)</option>
            <option value="ADMIN">ADMIN (ê´€ë¦¬ì)</option>
        </select>
    </div>

    <button onclick="getDevToken()" class="btn btn-primary w-100 mb-3">í† í° ë°œê¸‰ë°›ê¸° ğŸš€</button>

    <div id="resultArea" class="token-box">
        <strong class="d-block mb-1 text-success">ë°œê¸‰ ì„±ê³µ!</strong>
        <p id="accessTokenDisplay" class="mb-2"></p>
        <button onclick="copyToken()" class="btn btn-sm btn-outline-secondary w-100">ğŸ“‹ í† í° ë³µì‚¬í•˜ê¸°</button>
    </div>
</div>

<script>
    // í˜„ì¬ ì„œë²„ ì£¼ì†Œ (ë°°í¬ í™˜ê²½ì—ì„œë„ ë™ì‘í•˜ë„ë¡ ìƒëŒ€ ê²½ë¡œ ì‚¬ìš©)
    // ë§Œì•½ í”„ë¡ íŠ¸ì—”ë“œì™€ ë¶„ë¦¬ë˜ì–´ ìˆë‹¤ë©´ 'http://localhost:8080' ë“±ì„ ì§ì ‘ ì ì–´ì¤˜ì•¼ í•¨
    const BASE_URL = '';

    async function getDevToken() {
        const userId = document.getElementById('userId').value;
        const role = document.getElementById('role').value;
        const resultArea = document.getElementById('resultArea');
        const tokenDisplay = document.getElementById('accessTokenDisplay');

        try {
            // íŒ€ì¥ë‹˜ì´ ë§Œë“œì‹  API í˜¸ì¶œ
            const response = await fetch(`${BASE_URL}/dev/token?userId=${userId}&role=${role}`);

            if (!response.ok) {
                throw new Error(`Error: ${response.status}`);
            }

            const json = await response.json();

            // ì‘ë‹µ êµ¬ì¡°: { code: "SUCCESS", data: { accessToken: "..." } }
            const token = json.data.accessToken;

            // í™”ë©´ í‘œì‹œ
            tokenDisplay.innerText = token;
            resultArea.style.display = 'block';

            // ê°œë°œì ë„êµ¬ ì½˜ì†”ì—ë„ ì¶œë ¥ (í¸ì˜ì„±)
            console.log("Access Token:", token);

            // (ì„ íƒ) ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ìë™ ì €ì¥ -> í”„ë¡ íŠ¸ ê°œë°œí•  ë•Œ í¸í•¨
            localStorage.setItem('accessToken', token);

        } catch (error) {
            alert('í† í° ë°œê¸‰ ì‹¤íŒ¨! ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.');
            console.error(error);
        }
    }

    function copyToken() {
        const tokenText = document.getElementById('accessTokenDisplay').innerText;
        navigator.clipboard.writeText(tokenText).then(() => {
            alert('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! âœ¨');
        });
    }
</script>

</body>
</html>